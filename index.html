<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Downloader for Linux</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;500;600&family=Source+Sans+3:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap');
        
        :root {
            --cream: #FAF9F6;
            --warm-white: #FEFDFB;
            --sand: #E8E4DD;
            --terracotta: #CC785C;
            --terracotta-dark: #B8684D;
            --clay: #D4A574;
            --charcoal: #2D2D2D;
            --stone: #6B6B6B;
            --light-stone: #9A9A9A;
        }
        
        body {
            font-family: 'Source Sans 3', system-ui, sans-serif;
            background-color: var(--sand);
            color: var(--charcoal);
        }
        
        .font-serif { font-family: 'Crimson Pro', Georgia, serif; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        .text-terracotta { color: var(--terracotta); }
        .bg-terracotta { background-color: var(--terracotta); }
        .border-sand { border-color: var(--sand); }
        .bg-sand { background-color: var(--sand); }
        .text-stone { color: var(--stone); }
        .text-light-stone { color: var(--light-stone); }
        
        pre::-webkit-scrollbar { height: 8px; width: 8px; }
        pre::-webkit-scrollbar-track { background: var(--sand); border-radius: 4px; }
        pre::-webkit-scrollbar-thumb { background: var(--light-stone); border-radius: 4px; }
        pre::-webkit-scrollbar-thumb:hover { background: var(--stone); }
        
        .btn-primary {
            background-color: var(--terracotta);
            transition: all 0.2s ease;
        }
        .btn-primary:hover {
            background-color: var(--terracotta-dark);
        }
        
        .btn-secondary {
            background-color: var(--sand);
            color: var(--charcoal);
            transition: all 0.2s ease;
        }
        .btn-secondary:hover {
            background-color: #DDD9D2;
        }
        
        .card {
            background: var(--warm-white);
            border: 1px solid var(--sand);
        }
        
        .code-card {
            background: #2D2D2D;
            color: #E8E4DD;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto px-6 py-16 max-w-3xl">
        <!-- Header -->
        <header class="text-center mb-16">
            <div class="inline-flex items-center justify-center w-14 h-14 rounded-full bg-terracotta/10 mb-6">
                <svg class="w-7 h-7 text-terracotta" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814z"/>
                    <path fill="#FAF9F6" d="M9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                </svg>
            </div>
            <h1 class="font-serif text-4xl md:text-5xl font-semibold tracking-tight mb-4">
                YouTube Downloader
            </h1>
            <p class="text-stone text-lg">
                A simple Linux script to make yt-dlp easy.
            </p>
        </header>

        <!-- Modes -->
        <section class="mb-16">
            <h2 class="font-serif text-2xl font-medium mb-6">Download Modes</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="card rounded-xl p-6">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-8 h-8 rounded-full bg-terracotta/10 flex items-center justify-center">
                            <svg class="w-4 h-4 text-terracotta" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="font-medium">Video</h3>
                    </div>
                    <p class="text-stone text-sm">Full quality MP4 with chapters, subtitles, and thumbnail.</p>
                </div>
                <div class="card rounded-xl p-6">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-8 h-8 rounded-full bg-terracotta/10 flex items-center justify-center">
                            <svg class="w-4 h-4 text-terracotta" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <h3 class="font-medium">Single Frame</h3>
                    </div>
                    <p class="text-stone text-sm">Audio with static thumbnail. Keeps subtitles, ~90% smaller.</p>
                </div>
            </div>
        </section>

        <!-- Installation -->
        <section class="mb-16">
            <h2 class="font-serif text-2xl font-medium mb-6">Installation</h2>
            <div class="card rounded-xl p-6">
                <ol class="space-y-4">
                    <li class="flex items-start gap-4">
                        <span class="flex-shrink-0 w-6 h-6 rounded-full bg-terracotta/10 flex items-center justify-center text-sm font-medium text-terracotta">1</span>
                        <div>
                            <p>Save the script below as <code class="font-mono text-sm bg-sand px-2 py-0.5 rounded">ytdl.sh</code></p>
                        </div>
                    </li>
                    <li class="flex items-start gap-4">
                        <span class="flex-shrink-0 w-6 h-6 rounded-full bg-terracotta/10 flex items-center justify-center text-sm font-medium text-terracotta">2</span>
                        <div>
                            <p>Make it executable: <code class="font-mono text-sm bg-sand px-2 py-0.5 rounded">chmod +x ytdl.sh</code></p>
                        </div>
                    </li>
                    <li class="flex items-start gap-4">
                        <span class="flex-shrink-0 w-6 h-6 rounded-full bg-terracotta/10 flex items-center justify-center text-sm font-medium text-terracotta">3</span>
                        <div>
                            <p>Run it: <code class="font-mono text-sm bg-sand px-2 py-0.5 rounded">./ytdl.sh</code></p>
                        </div>
                    </li>
                </ol>
            </div>
        </section>

        <!-- Script -->
        <section>
            <div class="flex items-center justify-between mb-6">
                <h2 class="font-serif text-2xl font-medium">Script</h2>
                <div class="flex items-center gap-2">
                    <button onclick="copyScript()" class="btn-secondary flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium">
                        <svg id="copy-icon" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                        <span id="copy-text">Copy</span>
                    </button>
                    <button onclick="downloadScript()" class="btn-primary flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                        </svg>
                        <span>Download</span>
                    </button>
                </div>
            </div>
            <div class="code-card rounded-xl overflow-hidden">
                <div class="flex items-center gap-2 px-4 py-3 border-b border-white/10">
                    <div class="flex gap-1.5">
                        <div class="w-3 h-3 rounded-full bg-white/20"></div>
                        <div class="w-3 h-3 rounded-full bg-white/20"></div>
                        <div class="w-3 h-3 rounded-full bg-white/20"></div>
                    </div>
                    <span class="font-mono text-sm text-white/50">ytdl.sh</span>
                </div>
                <div class="p-4 max-h-[500px] overflow-auto">
                    <pre id="script-content" class="font-mono text-sm leading-relaxed"></pre>
                </div>
            </div>
        </section>
    </div>

    <script>
const bashScript = `#!/bin/bash
# YouTube Downloader for Linux
# Features: Auto-setup, Video download, Single-frame mode

set -e

RED='\\033[0;31m'
GREEN='\\033[0;32m'
YELLOW='\\033[1;33m'
BLUE='\\033[0;34m'
PURPLE='\\033[0;35m'
CYAN='\\033[0;36m'
NC='\\033[0m'

SCRIPT_DIR="$(cd "$(dirname "\${BASH_SOURCE[0]}")" && pwd)"
CONFIG_FILE="\${SCRIPT_DIR}/config.json"
YTDLP_BIN="\${SCRIPT_DIR}/yt-dlp"
COOKIES_FILE=""

print_header() {
    echo -e "\${PURPLE}"
    echo "╔═══════════════════════════════════════════════════════════════╗"
    echo "║              YouTube Downloader for Linux                     ║"
    echo "╚═══════════════════════════════════════════════════════════════╝"
    echo -e "\${NC}"
}

print_status() { echo -e "\${BLUE}[INFO]\${NC} \$1"; }
print_success() { echo -e "\${GREEN}[OK]\${NC} \$1"; }
print_warning() { echo -e "\${YELLOW}[WARN]\${NC} \$1"; }
print_error() { echo -e "\${RED}[ERROR]\${NC} \$1"; }

check_dependencies() {
    local missing=()
    if ! command -v curl &> /dev/null && ! command -v wget &> /dev/null; then
        missing+=("curl or wget")
    fi
    if ! command -v ffmpeg &> /dev/null; then
        missing+=("ffmpeg")
    fi
    if [ \${#missing[@]} -ne 0 ]; then
        print_error "Missing: \${missing[*]}"
        echo "Install with: sudo apt install curl ffmpeg"
        exit 1
    fi
}

download_file() {
    local url="\$1" output="\$2"
    if command -v curl &> /dev/null; then
        curl -L -o "\$output" "\$url"
    else
        wget -O "\$output" "\$url"
    fi
}

ensure_ytdlp() {
    if [ ! -f "\$YTDLP_BIN" ]; then
        print_status "Downloading yt-dlp..."
        local arch=""
        case "\$(uname -m)" in
            x86_64)  arch="yt-dlp_linux" ;;
            aarch64) arch="yt-dlp_linux_aarch64" ;;
            armv7l)  arch="yt-dlp_linux_armv7l" ;;
            *)       arch="yt-dlp" ;;
        esac
        if download_file "https://github.com/yt-dlp/yt-dlp/releases/latest/download/\${arch}" "\$YTDLP_BIN"; then
            chmod +x "\$YTDLP_BIN"
            print_success "yt-dlp ready!"
        else
            print_error "Failed to download yt-dlp"
            exit 1
        fi
    fi
}

update_ytdlp() {
    print_status "Checking for updates..."
    "\$YTDLP_BIN" -U || true
}

read_config() {
    if [ -f "\$CONFIG_FILE" ]; then
        DOWNLOAD_DIR=\$(grep -oP '"download_dir"\\s*:\\s*"\\K[^"]+' "\$CONFIG_FILE" 2>/dev/null || echo "")
        if [ -n "\$DOWNLOAD_DIR" ] && [ -d "\$DOWNLOAD_DIR" ]; then
            return 0
        fi
    fi
    return 1
}

write_config() {
    echo "{\\"download_dir\\": \\"\$1\\"}" > "\$CONFIG_FILE"
}

setup_config() {
    echo ""
    print_status "Setup - Configure download location"
    echo -e "Default: \${CYAN}\${SCRIPT_DIR}\${NC}"
    read -p "Download directory (Enter for default): " user_dir
    
    if [ -z "\$user_dir" ]; then
        DOWNLOAD_DIR="\$SCRIPT_DIR"
    else
        DOWNLOAD_DIR="\${user_dir/#\\~/\$HOME}"
    fi
    
    mkdir -p "\$DOWNLOAD_DIR" 2>/dev/null || DOWNLOAD_DIR="\$SCRIPT_DIR"
    write_config "\$DOWNLOAD_DIR"
    print_success "Saved!"
}

find_cookies() {
    for loc in "\$SCRIPT_DIR/cookies.txt" "\$DOWNLOAD_DIR/cookies.txt" "\$HOME/cookies.txt"; do
        if [ -f "\$loc" ]; then
            COOKIES_FILE="\$loc"
            print_status "Using cookies: \$loc"
            return 0
        fi
    done
    return 1
}

download_video() {
    local url="\$1"
    print_status "Downloading video..."
    local args=("-f" "bestvideo*+bestaudio/best" "-S" "res,ext:mp4:m4a" "--recode" "mp4"
        "--embed-thumbnail" "--embed-chapters" "--embed-subs" "--sub-langs" "en"
        "--write-auto-subs" "--fragment-retries" "999" "--no-mtime")
    [ -n "\$COOKIES_FILE" ] && args+=("--cookies" "\$COOKIES_FILE")
    args+=("\$url")
    "\$YTDLP_BIN" "\${args[@]}"
}

download_single_frame() {
    local url="\$1"
    print_status "Creating single-frame video..."
    
    local title safe_title temp_dir output_file
    title=\$("\$YTDLP_BIN" --get-filename -o "%(title)s" "\$url" 2>/dev/null | head -1)
    safe_title=\$(echo "\$title" | tr -cd '[:alnum:] ._-' | tr ' ' '_' | cut -c1-200)
    temp_dir=\$(mktemp -d)
    output_file="\${DOWNLOAD_DIR}/\${safe_title}_singleframe.mp4"
    
    trap "rm -rf \$temp_dir" EXIT
    
    print_status "Downloading source..."
    local dl_args=("-f" "bestvideo*+bestaudio/best" "-S" "res:480,ext:mp4:m4a" "--recode" "mp4"
        "--embed-subs" "--sub-langs" "en" "--write-auto-subs" "--write-thumbnail" "-o" "\${temp_dir}/video.mp4")
    [ -n "\$COOKIES_FILE" ] && dl_args+=("--cookies" "\$COOKIES_FILE")
    dl_args+=("\$url")
    "\$YTDLP_BIN" "\${dl_args[@]}"
    
    local actual_video=\$(find "\$temp_dir" -name "video*" -type f | grep -E '\\.(mp4|mkv|webm)$' | head -1)
    local actual_thumb=\$(find "\$temp_dir" -name "video*" -type f | grep -E '\\.(jpg|jpeg|png|webp)$' | head -1)
    
    [ -z "\$actual_video" ] && { print_error "Video not found"; exit 1; }
    
    local duration=\$(ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 "\$actual_video")
    
    if [ -n "\$actual_thumb" ]; then
        ffmpeg -y -i "\$actual_thumb" -vf "scale=1920:1080:force_original_aspect_ratio=decrease,pad=1920:1080:(ow-iw)/2:(oh-ih)/2:black" "\${temp_dir}/frame.jpg" 2>/dev/null
    else
        ffmpeg -y -ss 5 -i "\$actual_video" -vframes 1 -q:v 2 "\${temp_dir}/frame.jpg" 2>/dev/null
    fi
    
    print_status "Creating output..."
    ffmpeg -y -loop 1 -i "\${temp_dir}/frame.jpg" -i "\$actual_video" \\
        -map 0:v:0 -map 1:a:0 \\
        -c:v libx264 -tune stillimage -crf 28 -preset fast \\
        -c:a aac -b:a 192k -t "\$duration" \\
        -movflags +faststart -pix_fmt yuv420p \\
        "\$output_file" 2>/dev/null
    
    if [ -f "\$output_file" ]; then
        local orig=\$(du -h "\$actual_video" | cut -f1)
        local new=\$(du -h "\$output_file" | cut -f1)
        print_success "Done! \$orig → \$new"
        echo -e "Output: \${CYAN}\$output_file\${NC}"
    else
        print_error "Failed"
        exit 1
    fi
}

show_menu() {
    echo ""
    echo -e "\${CYAN}Options:\${NC}"
    echo "  1) Video (full quality MP4)"
    echo "  2) Single Frame (audio + thumbnail)"
    echo "  3) Update yt-dlp"
    echo "  4) Change directory"
    echo "  5) Exit"
    echo ""
}

get_url() {
    while true; do
        read -p "URL: " url
        [[ "\$url" =~ ^https?:// ]] && { echo "\$url"; return; }
        print_error "Invalid URL"
    done
}

main() {
    print_header
    check_dependencies
    ensure_ytdlp
    read_config || setup_config
    find_cookies || true
    cd "\$DOWNLOAD_DIR" || exit 1
    print_status "Directory: \$DOWNLOAD_DIR"
    
    while true; do
        show_menu
        read -p "Select [1-5]: " choice
        case "\$choice" in
            1) url=\$(get_url); update_ytdlp; download_video "\$url"; print_success "Done!" ;;
            2) url=\$(get_url); update_ytdlp; download_single_frame "\$url" ;;
            3) update_ytdlp; print_success "Updated!" ;;
            4) setup_config; cd "\$DOWNLOAD_DIR" ;;
            5) echo "Bye!"; exit 0 ;;
            *) print_warning "Invalid option" ;;
        esac
        read -p "Press Enter..."
    done
}

main "\$@"
`;

        document.getElementById('script-content').textContent = bashScript;

        function copyScript() {
            navigator.clipboard.writeText(bashScript).then(() => {
                const btn = document.getElementById('copy-text');
                const icon = document.getElementById('copy-icon');
                btn.textContent = 'Copied!';
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
                setTimeout(() => {
                    btn.textContent = 'Copy';
                    icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>';
                }, 2000);
            });
        }

        function downloadScript() {
            const blob = new Blob([bashScript], { type: 'text/x-shellscript' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ytdl.sh';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        window.copyScript = copyScript;
        window.downloadScript = downloadScript;
    </script>
</body>
</html>
